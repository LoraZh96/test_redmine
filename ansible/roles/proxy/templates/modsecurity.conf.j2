# --- ModSecurity v3 core configuration ---
SecRuleEngine On

# Request/Response body access
SecRequestBodyAccess On
SecResponseBodyAccess Off
SecResponseBodyLimit 524288
SecRequestBodyLimit 20971520
SecRequestBodyNoFilesLimit 1048576

# Audit log
SecAuditEngine RelevantOnly
SecAuditLogParts ABIJDEFHZ
SecAuditLogType Serial
SecAuditLog /var/log/modsecurity/audit.log
SecAuditLogStorageDir /var/log/modsecurity/audit

# Logs/Debug 
SecDebugLogLevel 0
# SecDebugLog /var/log/modsecurity/debug.log

# Sensible defaults
SecPcreMatchLimit 100000
SecPcreMatchLimitRecursion 100000
SecRuleRemoveById 999999  # placeholder

